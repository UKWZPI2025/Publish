<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Ortodonta123</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link href="style/style.css" rel="stylesheet" type="text/css" />


</head>


<body>
<div class="main">
  <div class="header">
    <div class="header_resize">
      <div class="logo">
        <h1><a href="#"><span>O</span>rtodonta123</a> <small>klinika ortodontyczna</small></h1>
      </div>
      <div class="clr"></div>
      <div class="menu_nav">
		  <ul class="main_menu">
			  <li><a href="index_uzytkownik.html">Home</a></li>
			  <li><a href="wizyty_uzytkownik.html">Wizyty</a></li>
			  <li class="active"><a href="wiadomosci_uzytkownik.html">Wiadomości i powiadomienia</a></li>
			  <li><a href="panel_uzytkownik.html">Panel użytkownika</a></li>
			</ul>

		  <ul class="user_menu">
			<li><a id="powitanie" href="#">Witaj!</a></li>
			<li><a href="index_gosc.html">Wyloguj</a></li>
		  </ul>
		</div>

    </div>
  </div>
  
	  
	  <div class="content">
	  <div class="content_resize">
		<div class="clr"></div>
		<div class="mainbar">
		  <div class="article">
			<h2 class="fancy-title" style="text-align: center;">Wiadomości i Powiadomienia</h2>
			<form action="#" method="post" style="max-width: 600px; margin: 0 auto; font-size: 14px;">
			  
			  
			  <!-- Toggle odbierania push -->
            <p>
              <label>
                <input type="checkbox" id="pushToggle" />
                Odbieraj powiadomienia o wizytach (push)
              </label>
            </p>
            <p id="pushStatus" style="color: green; display: none;">
              Subskrypcja aktywna – zaraz dostaniesz testowe powiadomienie.
            </p>

            <hr />
			
			<!-- Link potwierdzający wizytę -->
            <p>
              <button id="generateLinkBtn" style="padding: 6px 10px;" class="edytuj-form">Wygeneruj link potwierdzający wizytę</button>
            </p>
            <p id="linkContainer"></p>
            <p id="confirmStatus" style="color: green; display: none;">
              Wizyta została potwierdzona!
            </p>
			  
			  <p>
				  <label style="font-size: 16px;">Preferowane czasy przypomnienia:</label><br />
				  <div style="border: 1px solid #ccc; padding: 8px; display: inline-block; max-width: 280px; font-size: 14px;">
					<label><input type="checkbox" name="reminder_time[]" value="24" /> dzień przed wizytą</label><br />
					<label><input type="checkbox" name="reminder_time[]" value="12" /> 12 godzin przed wizytą</label><br />
					<label><input type="checkbox" name="reminder_time[]" value="2" /> 2 godziny przed wizytą</label><br />
					<label><input type="checkbox" name="reminder_time[]" value="1" /> 1 godzina przed wizytą</label>
				  </div>
				</p>



			  
			  <p>
				<label>
				  <input type="checkbox" name="mute_night" />
				  Wyłącz powiadomienia w godzinach nocnych (22:00–6:00)
				</label>
			  </p>
			  
			  <p style="text-align: center;">
				  <button type="submit" class="edytuj-form">Zapisz ustawienia</button>
				</p>

			</form>
		  </div>
		</div>
		<div class="clr"></div>
	  </div>
	</div>

  
  <script type="text/javascript">
  function showCookiePolicy() {
    document.getElementById("cookieModal").style.display = "block";
  }
  </script>


  
  <div class="fbg">
      <div class="fbg_resize">
        <div class="contact_wrapper">
          <div class="contact_left">
            <p><strong>Poniedziałek:</strong> 08:00 – 16:00</p>
            <p><strong>Wtorek:</strong> 08:00 – 16:00</p>
            <p><strong>Środa:</strong> 08:00 – 16:00</p>
            <p><strong>Czwartek:</strong> 08:00 – 16:00</p>
            <p><strong>Piątek:</strong> 08:00 – 16:00</p>
            <p><strong>Sobota:</strong> Nieczynne</p>
            <p><strong>Niedziela:</strong> Nieczynne</p>
          </div>
          <div class="contact_right">
            <p><strong>Email:</strong> <a href="mailto:kontakt@firma.pl">kontakt@firma.pl</a></p>
            <p><strong>Telefon:</strong> <a href="tel:+48123456789">+48 123 456 789</a></p>
            <p><strong>Adres:</strong> ul. Przykładowa 1, 00-001 Warszawa</p>
			<p><a href="#" onclick="showCookiePolicy()">informacje o ciasteczkach</a></p>
          </div>
        </div>
        <div class="clr"></div>
      </div>
    </div>
  <div class="footer">
      <div class="footer_resize">
        <div class="clr"></div>
      </div>
    </div>




<!-- MODAL -->
<div id="cookieModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999;">
  <div style="background:white; width:80%; max-width:700px; margin:10% auto; padding:20px; border-radius:10px;">
    <h2>Polityka ciasteczek</h2>
    <p style="text-align:justify; max-height:60vh; overflow-y:auto;">
      Nasza strona internetowa używa ciasteczek, aby zapewnić Ci jak najlepsze doświadczenia podczas przeglądania.
      Ciasteczka to małe pliki tekstowe przechowywane na Twoim urządzeniu, które pozwalają nam zapamiętać Twoje preferencje i ustawienia.<br><br>

      <strong>Jakie ciasteczka stosujemy?</strong><br>
      Ciasteczka niezbędne – umożliwiają prawidłowe funkcjonowanie strony, takie jak logowanie do konta.<br>
      Ciasteczka analityczne – pozwalają analizować, jak użytkownicy korzystają ze strony.<br>
      Ciasteczka marketingowe – służą do wyświetlania dopasowanych reklam.<br><br>

      <strong>Zarządzanie ciasteczkami:</strong><br>
      Możesz zarządzać ustawieniami w przeglądarce. Zablokowanie ciasteczek może wpłynąć na działanie strony.<br><br>

      Klikając „Akceptuję” lub kontynuując korzystanie z naszej strony, wyrażasz zgodę na używanie ciasteczek zgodnie z naszą polityką.
    </p>
    <div style="text-align:center; margin-top:20px;">
  <button onclick="document.getElementById('cookieModal').style.display='none';">Akceptuję</button>
	</div>

  </div>
</div>






<!-- skrypt do powiadomieniach push -->


<script>
    // 1) Rejestracja Service Workera
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('js/sw.js').catch(console.error);
    }

    // 2) Obsługa toggle push
    const pushToggle = document.getElementById('pushToggle');
    const pushStatus = document.getElementById('pushStatus');

    pushToggle.addEventListener('change', async () => {
      if (!('Notification' in window) || !('serviceWorker' in navigator)) {
        alert('Twoja przeglądarka nie obsługuje powiadomień push.');
        pushToggle.checked = false;
        return;
      }
      if (pushToggle.checked) {
        const perm = await Notification.requestPermission();
        if (perm !== 'granted') {
          alert('Odrzucono pozwolenie na powiadomienia.');
          pushToggle.checked = false;
          return;
        }
        // Wyślij testowe powiadomienie
        const reg = await navigator.serviceWorker.ready;
        reg.showNotification('Ortodonta123', {
          body: 'Dziękujemy za subskrypcję powiadomień o wizytach!',
          tag: 'test-push'
        });
        pushStatus.style.display = 'block';
      } else {
        // W „realnej” implementacji tu by było wypisanie z subskrypcji na serwerze
        pushStatus.style.display = 'none';
        alert('Anulowano subskrypcję powiadomień.');
      }
    });

    // 3) Generowanie i obsługa linku potwierdzającego wizytę
    const genBtn = document.getElementById('generateLinkBtn');
    const linkContainer = document.getElementById('linkContainer');
    const confirmStatus = document.getElementById('confirmStatus');

    genBtn.addEventListener('click', () => {
      // Symulujemy unikalny token
      const token = Math.random().toString(36).substring(2, 10);
      const link = document.createElement('a');
      link.href = '#';
      link.textContent = 'Potwierdź wizytę';
      link.dataset.token = token;
      linkContainer.innerHTML = '';
      linkContainer.appendChild(link);

      // Obsługa kliknięcia
      link.addEventListener('click', (e) => {
        e.preventDefault();
        // W rzeczywistości tutaj wyleciałoby żądanie do API, np. fetch('/api/confirm?token=' + token)
        confirmStatus.style.display = 'block';
        linkContainer.style.display = 'none';
      });
    });
    </script>





<!-- skrypt do czasu przypomnienia -->

<script>
  function toggleDropdown() {
    const menu = document.getElementById("dropdownMenu");
    menu.style.display = menu.style.display === "none" ? "block" : "none";
  }

  // Zamknij menu po kliknięciu poza nim
  document.addEventListener("click", function(event) {
    const dropdown = document.getElementById("reminderDropdown");
    if (!dropdown.contains(event.target)) {
      document.getElementById("dropdownMenu").style.display = "none";
    }
  });

   const imie = localStorage.getItem("imie");
  const nazwisko = localStorage.getItem("nazwisko");

  if (imie && nazwisko) {
    document.getElementById("powitanie").textContent = `Witaj ${imie} ${nazwisko}!`;
  }
</script>



</body>
</html>
